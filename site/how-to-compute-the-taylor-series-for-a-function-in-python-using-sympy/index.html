

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  
    <title>How to compute the Taylor series for a function (in Python, using SymPy) - How to Data</title>

    
  

  <link rel="shortcut icon" href="/how2data/site/favicon.ico" type="image/x-icon">

  <link rel="stylesheet" href="/how2data/site/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/how2data/site/assets/js/vendor/lunr.min.js"></script>
  
  <script type="text/javascript" src="/how2data/site/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>How to compute the Taylor series for a function (in Python, using SymPy) | How to Data</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="How to compute the Taylor series for a function (in Python, using SymPy)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reference site for common computing tasks in statistics and data science" />
<meta property="og:description" content="Reference site for common computing tasks in statistics and data science" />
<link rel="canonical" href="/how2data/site/how-to-compute-the-taylor-series-for-a-function-in-python-using-sympy/" />
<meta property="og:url" content="/how2data/site/how-to-compute-the-taylor-series-for-a-function-in-python-using-sympy/" />
<meta property="og:site_name" content="How to Data" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to compute the Taylor series for a function (in Python, using SymPy)" />
<script type="application/ld+json">
{"@type":"WebPage","url":"/how2data/site/how-to-compute-the-taylor-series-for-a-function-in-python-using-sympy/","description":"Reference site for common computing tasks in statistics and data science","headline":"How to compute the Taylor series for a function (in Python, using SymPy)","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  
<!--
  --
  --  Configure MathJax to permit $...$ for inline matht
  --
  -->

<script type="text/javascript">
    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']]
        },
        svg: {
            fontCache: 'global'
        }
    }
</script>

<!--
  --
  --  Import MathJax
  --
  -->

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript"
        id="MathJax-script"
        async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

<!--
  --
  --  Fix inconsistent gutter width for code cells
  --  And let tables wrap rather than need to scroll.
  --  (Otherwise it's not even obvious that there's content to scroll to.)
  --
  -->

<style>
    .rouge-gutter {
        width: 3em;
    }
    .main-content table a {
        white-space: unset;
    }
</style>

<!--
  --
  --  Add copy buttons to all code input cells
  --  and make those cells slightly visually distinctive
  --
  -->

<script type="text/javascript">
    function makeButton () {
        const button = document.createElement( 'button' )
        button.setAttribute( 'aria-label', 'Copy code to clipboard' )
        button.innerText = 'Copy'
        button.style.float = 'right'
        button.classList.add( 'btn' )
        return button
    }
    const isNotPlainText = element =>
        !element.classList.contains( 'language-plaintext' ) &&
        ( !( element.parentNode instanceof Element )
            || isNotPlainText( element.parentNode ) )
    window.addEventListener( 'load', () => {
        Array.from( document.body.getElementsByClassName( 'rouge-code' ) )
        .forEach( codeBlock => {
            if ( isNotPlainText( codeBlock ) ) {
                // If it's an input code block, do this:
                // 1. Insert the "copy" button
                const button = makeButton()
                codeBlock.insertBefore( button, codeBlock.childNodes[0] )
                button.addEventListener( 'click', () => {
                    button.innerText = '' // don't copy the word "copy"
                    window.navigator.clipboard.writeText( codeBlock.innerText )
                    button.innerText = 'Copied!'
                    setTimeout( () => button.innerText = 'Copy', 3000 )
                } )
                // 2. Adjust border style
                const surrounding = codeBlock.closest( '.highlighter-rouge' )
                if ( surrounding )
                    surrounding.style.border = '1px solid #2869e6'
            } else {
                // But if it's an output code block, remove the line numbers.
                const surrounding = codeBlock.closest( '.highlighter-rouge' )
                if ( surrounding )
                    Array.from( surrounding.querySelectorAll('.lineno') )
                    .forEach( lineno => lineno.style.visibility = 'hidden' )
            }
        } )
    } )
</script>

<!--
  --
  --  Add logo image above nav bar
  --
  -->

<style>
    .nav-list {
        padding-top: 180px;
        background-image: url(/how2data/site/assets/images/H2Dlogo2.svg);
        background-repeat: no-repeat;
        background-position: 24px -2px;
        background-size: 153px 153px;
    }
</style>



</head>

<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="/how2data/site/" class="site-title lh-tight">
  How to Data

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
        <ul class="nav-list"><li class="nav-list-item"><a href="/how2data/site/" class="nav-list-link">Welcome</a></li><li class="nav-list-item"><a href="/how2data/site/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="/how2data/site/topics/" class="nav-list-link">Topics</a></li><li class="nav-list-item"><a href="/how2data/site/tasks/" class="nav-list-link">Tasks</a></li><li class="nav-list-item"><a href="/how2data/site/software/" class="nav-list-link">Software Packages</a></li><li class="nav-list-item"><a href="/how2data/site/acknowledgments/" class="nav-list-link">Acknowledgments</a></li><li class="nav-list-item"><a href="/how2data/site/contributing/" class="nav-list-link">Contributing</a></li></ul>

      
    </nav>
    <footer class="site-footer">
      This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.
    </footer>
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      
        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search How to Data" aria-label="Search How to Data" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
      
      <div id="main-content" class="main-content" role="main">
        
          <h1 id="how-to-compute-the-taylor-series-for-a-function-in-python-using-sympy">
        
        
          <a href="#how-to-compute-the-taylor-series-for-a-function-in-python-using-sympy" class="anchor-heading" aria-labelledby="how-to-compute-the-taylor-series-for-a-function-in-python-using-sympy"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to compute the Taylor series for a function (in Python, using SymPy)
        
        
      </h1>
    

<p><a href="../how-to-compute-the-taylor-series-for-a-function">See all solutions.</a></p>
      <h2 id="task">
        
        
          <a href="#task" class="anchor-heading" aria-labelledby="task"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Task
        
        
      </h2>
    

<p>Any function that has arbitrarily many derivatives at a given point
can have a Taylor series computed for the function centered at that point.
How can we ask symbolic mathematics software to do this for us?</p>

<p>Related tasks:</p>

<ul>
  <li><a href="../how-to-compute-the-error-bounds-on-a-taylor-approximation">How to compute the error bounds on a Taylor approximation</a></li>
</ul>
      <h2 id="solution">
        
        
          <a href="#solution" class="anchor-heading" aria-labelledby="solution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Solution
        
        
      </h2>
    

<!-- beginning of wrapper -->

<p>This answer assumes you have imported SymPy as follows.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>                   <span class="c1"># load all math functions
</span><span class="n">init_printing</span><span class="p">(</span> <span class="n">use_latex</span><span class="o">=</span><span class="s">'mathjax'</span> <span class="p">)</span>  <span class="c1"># use pretty math output
</span></pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Let’s define an example function whose Taylor series we’d like to compute.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">var</span><span class="p">(</span> <span class="s">'x'</span> <span class="p">)</span>
<span class="n">formula</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">)</span>
<span class="n">formula</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>$\displaystyle e^{2 x + 1}$</p>

<p>Let’s ask for a degree-5 Taylor series centered at $x=2$.  From the code below,
you can tell that the third parameter is the center point and the fourth
parameter is the degree.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">series</span><span class="p">(</span> <span class="n">formula</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>$\displaystyle e^{5} + 2 \left(x - 2\right) e^{5} + 2 \left(x - 2\right)^{2} e^{5} + \frac{4 \left(x - 2\right)^{3} e^{5}}{3} + \frac{2 \left(x - 2\right)^{4} e^{5}}{3} + O\left(\left(x - 2\right)^{5}; x\rightarrow 2\right)$</p>

<p>The final term (starting with O—oh, not zero) means that there are more terms
in the infinite Taylor series not shown in this finite approximation.
If you want to show just the approximation, you can tell it to remove the O term.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">series</span><span class="p">(</span> <span class="n">formula</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span> <span class="p">).</span><span class="n">removeO</span><span class="p">()</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>$\displaystyle \frac{2 \left(x - 2\right)^{4} e^{5}}{3} + \frac{4 \left(x - 2\right)^{3} e^{5}}{3} + 2 \left(x - 2\right)^{2} e^{5} + 2 \left(x - 2\right) e^{5} + e^{5}$</p>

<p>You can also compute individual coefficients in a Taylor series
by remembering the formula for the $n^\text{th}$ term in the series and applying it,
as follows.  The formula for a series centered on $x=a$ is $\frac{f^{(n)}(a)}{n!}$.</p>

<p>From the answer above, we can see that the coefficient on the $n=3$ term is $\frac43e^5$.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">diff</span><span class="p">(</span> <span class="n">formula</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span> <span class="p">).</span><span class="n">subs</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span> <span class="p">)</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>$\displaystyle \frac{4 e^{5}}{3}$</p>

<p>Content last modified on 02 June 2021.</p>

<p>See a problem?  <a href="https://github.com/nathancarter/how2data/issues/new/choose">Tell us</a> or <a href="https://github.com/nathancarter/how2data/tree/main/database/tasks/How to compute the Taylor series for a function/Python, using SymPy.ipynb">edit the source</a>.</p>

<!-- ending of wrapper -->

<p>Contributed by Nathan Carter (ncarter@bentley.edu)</p>

        

        

        
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>
</html>


