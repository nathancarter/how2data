

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  
    <title>How to do a Kruskal-Wallis test - How to Data</title>

    
  

  <link rel="shortcut icon" href="/how2data/site/favicon.ico" type="image/x-icon">


  <link rel="stylesheet" href="/how2data/site/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/how2data/site/assets/js/vendor/lunr.min.js"></script>
  

  

  <script type="text/javascript" src="/how2data/site/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to do a Kruskal-Wallis test | How to Data</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="How to do a Kruskal-Wallis test" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reference site for common computing tasks in statistics and data science" />
<meta property="og:description" content="Reference site for common computing tasks in statistics and data science" />
<link rel="canonical" href="/how2data/site/how-to-do-a-kruskal-wallis-test/" />
<meta property="og:url" content="/how2data/site/how-to-do-a-kruskal-wallis-test/" />
<meta property="og:site_name" content="How to Data" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to do a Kruskal-Wallis test" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Reference site for common computing tasks in statistics and data science","headline":"How to do a Kruskal-Wallis test","url":"/how2data/site/how-to-do-a-kruskal-wallis-test/"}</script>
<!-- End Jekyll SEO tag -->


  
<!--
  --
  --  Configure MathJax to permit $...$ for inline matht
  --
  -->

<script type="text/javascript">
    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']]
        },
        svg: {
            fontCache: 'global'
        }
    }
</script>

<!--
  --
  --  Import MathJax
  --
  -->

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript"
        id="MathJax-script"
        async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

<!--
  --
  --  Fix inconsistent gutter width for code cells
  --  And let tables wrap rather than need to scroll.
  --  (Otherwise it's not even obvious that there's content to scroll to.)
  --
  -->

<style>
    .rouge-gutter {
        width: 3em;
    }
    .main-content table a {
        white-space: unset;
    }
</style>

<!--
  --
  --  Add copy buttons to all code input cells
  --  and make those cells slightly visually distinctive
  --
  -->

<script type="text/javascript">
    function makeButton () {
        const button = document.createElement( 'button' )
        button.setAttribute( 'aria-label', 'Copy code to clipboard' )
        button.innerText = 'Copy'
        button.style.float = 'right'
        button.classList.add( 'btn' )
        return button
    }
    const isNotPlainText = element =>
        !element.classList.contains( 'language-plaintext' ) &&
        ( !( element.parentNode instanceof Element )
            || isNotPlainText( element.parentNode ) )
    window.addEventListener( 'load', () => {
        Array.from( document.body.getElementsByClassName( 'rouge-code' ) )
        .forEach( codeBlock => {
            if ( isNotPlainText( codeBlock ) ) {
                // If it's an input code block, do this:
                // 1. Insert the "copy" button
                const button = makeButton()
                codeBlock.insertBefore( button, codeBlock.childNodes[0] )
                button.addEventListener( 'click', () => {
                    button.innerText = '' // don't copy the word "copy"
                    window.navigator.clipboard.writeText( codeBlock.innerText )
                    button.innerText = 'Copied!'
                    setTimeout( () => button.innerText = 'Copy', 3000 )
                } )
                // 2. Adjust border style
                const surrounding = codeBlock.closest( '.highlighter-rouge' )
                if ( surrounding )
                    surrounding.style.border = '1px solid #2869e6'
            } else {
                // But if it's an output code block, remove the line numbers.
                const surrounding = codeBlock.closest( '.highlighter-rouge' )
                if ( surrounding )
                    Array.from( surrounding.querySelectorAll('.lineno') )
                    .forEach( lineno => lineno.style.visibility = 'hidden' )
            }
        } )
    } )
</script>

<!--
  --
  --  Add logo image above nav bar
  --
  -->

<style>
    .nav-list {
        padding-top: 180px;
        background-image: url(/how2data/site/assets/images/H2Dlogo2.svg);
        background-repeat: no-repeat;
        background-position: 24px -2px;
        background-size: 153px 153px;
    }
</style>



</head>

<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
    <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="/how2data/site/" class="site-title lh-tight">
  How to Data

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
      
        <ul class="nav-list"><li class="nav-list-item"><a href="/how2data/site/" class="nav-list-link">Welcome</a></li><li class="nav-list-item"><a href="/how2data/site/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="/how2data/site/topics/" class="nav-list-link">Topics</a></li><li class="nav-list-item"><a href="/how2data/site/tasks/" class="nav-list-link">Tasks</a></li><li class="nav-list-item"><a href="/how2data/site/software/" class="nav-list-link">Software Packages</a></li><li class="nav-list-item"><a href="/how2data/site/acknowledgments/" class="nav-list-link">Acknowledgments</a></li><li class="nav-list-item"><a href="/how2data/site/contributing/" class="nav-list-link">Contributing</a></li></ul>
      
      
    </nav>

    
    
      

    
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      

        

        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search How to Data" aria-label="Search How to Data" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
      
      <div id="main-content" class="main-content" role="main">
        
          <h1 id="how-to-do-a-kruskal-wallis-test">
        
        
          <a href="#how-to-do-a-kruskal-wallis-test" class="anchor-heading" aria-labelledby="how-to-do-a-kruskal-wallis-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to do a Kruskal-Wallis test
        
        
      </h1>
    
      <h2 id="description">
        
        
          <a href="#description" class="anchor-heading" aria-labelledby="description"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Description
        
        
      </h2>
    

<p>If we have samples from several independent populations, we might want to test
whether the population medians are equal.
We may not be able to assume anything about the populations’ variances,
nor whether they are normally distributed, but we do assume that the
populations have distributions that are approximately the same shape.
The Kruskal-Wallis Test will allow us to test the medians for equality.
It is similar to a One-Way ANOVA but using medians instead of means.
How do we perform a Kruskal-Wallis Test?</p>

<p>Related tasks:</p>

<ul>
  <li><a href="../how-to-do-a-one-way-analysis-of-variance-anova">How to do a one-way analysis of variance (ANOVA)</a></li>
  <li><a href="../how-to-use-bonferroni-s-correction-method">How to use Bonferroni’s Correction method</a></li>
  <li><a href="../how-to-do-a-wilcoxon-rank-sum-test">How to do a Wilcoxon rank-sum test</a></li>
</ul>
      <h2 id="using-scipy-in-python">
        
        
          <a href="#using-scipy-in-python" class="anchor-heading" aria-labelledby="using-scipy-in-python"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Using SciPy, in Python
        
        
      </h2>
    

<p><a href="../how-to-do-a-kruskal-wallis-test-in-python-using-scipy">View this solution alone.</a></p>

<p>For the purposes of this example, let’s say we have a sample of GPAs from
matriculated students at three Ivy League institutions:
Harvard, Dartmouth, and Columbia. This is example data, and you can replace it
with your actual data when you re-use this code.</p>

<p>SciPy requires our data to be in NumPy arrays, as shown below.
Note that pandas Series (e.g., columns in a DataFrame) are also NumPy arrays.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="c1"># Replace the fake data below with your real data
</span><span class="n">harvard</span>   <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.40</span><span class="p">,</span> <span class="mf">3.66</span><span class="p">,</span> <span class="mf">3.90</span><span class="p">,</span> <span class="mf">3.55</span><span class="p">,</span> <span class="mf">3.90</span><span class="p">,</span> <span class="mf">3.58</span><span class="p">])</span>
<span class="n">dartmouth</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">3.90</span><span class="p">,</span> <span class="mf">3.97</span><span class="p">,</span> <span class="mf">3.92</span><span class="p">,</span> <span class="mf">3.83</span><span class="p">,</span> <span class="mf">4.00</span><span class="p">,</span> <span class="mf">3.68</span><span class="p">])</span>
<span class="n">columbia</span>  <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.00</span><span class="p">,</span> <span class="mf">3.75</span><span class="p">,</span> <span class="mf">3.34</span><span class="p">])</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>The Kruskal-Willis Test uses a null hypothesis that the category medians are equal,
$H_0: m_C = m_H = m_D \le 0$.
We choose $\alpha$, or the Type I error rate, as 0.05 and run the test as shown below.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="n">stats</span><span class="p">.</span><span class="n">kruskal</span><span class="p">(</span><span class="n">harvard</span><span class="p">,</span> <span class="n">dartmouth</span><span class="p">,</span> <span class="n">columbia</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>KruskalResult(statistic=3.706006006006005, pvalue=0.15676569090635095)
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>The p-value, 0.1568, is greater than $\alpha$, so we fail to reject the null hypothesis.
We do not have sufficient evidence to conclude that the median GPAs
of matriculated students at these three schools are different from each other.</p>

<p>Content last modified on 05 October 2021.</p>

<p>See a problem?  <a href="https://github.com/nathancarter/how2data/issues/new/choose">Tell us</a> or <a href="https://github.com/nathancarter/how2data/tree/main/database/tasks/How to do a Kruskal-Wallis test/Python, using SciPy.ipynb">edit the source</a>.</p>
      <h2 id="solution-in-r">
        
        
          <a href="#solution-in-r" class="anchor-heading" aria-labelledby="solution-in-r"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Solution, in R
        
        
      </h2>
    

<p><a href="../how-to-do-a-kruskal-wallis-test-in-r">View this solution alone.</a></p>

<p>For the purposes of this example, let’s say we have a sample of GPAs from
matriculated students at three Ivy League institutions:
Harvard, Dartmouth, and Columbia. This is example data, and you can replace it
with your actual data when you re-use this code.</p>

<p>R requires that our categories and our numeric sample values be in separate vectors.
We could structure our data as follows.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="n">gpas</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w"> </span><span class="m">3.40</span><span class="p">,</span><span class="w"> </span><span class="m">3.66</span><span class="p">,</span><span class="w"> </span><span class="m">3.90</span><span class="p">,</span><span class="w"> </span><span class="m">3.55</span><span class="p">,</span><span class="w"> </span><span class="m">3.90</span><span class="p">,</span><span class="w"> </span><span class="m">3.58</span><span class="p">,</span><span class="w">
           </span><span class="m">3.90</span><span class="p">,</span><span class="w"> </span><span class="m">3.97</span><span class="p">,</span><span class="w"> </span><span class="m">3.92</span><span class="p">,</span><span class="w"> </span><span class="m">3.83</span><span class="p">,</span><span class="w"> </span><span class="m">4.00</span><span class="p">,</span><span class="w"> </span><span class="m">3.68</span><span class="p">,</span><span class="w">
           </span><span class="m">4.00</span><span class="p">,</span><span class="w"> </span><span class="m">3.75</span><span class="p">,</span><span class="w"> </span><span class="m">3.34</span><span class="w"> </span><span class="p">)</span><span class="w">
</span><span class="n">schools</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="w">
    </span><span class="s2">"Harvard"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Harvard"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Harvard"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Harvard"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Harvard"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Harvard"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Dartmouth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Dartmouth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Dartmouth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Dartmouth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Dartmouth"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Dartmouth"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"Columbia"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Columbia"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Columbia"</span><span class="w"> </span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></div></code></pre></div></div>

<p>The Kruskal-Willis Test uses a null hypothesis that the category medians are equal,
$H_0: m_C = m_H = m_D \le 0$.
We choose $\alpha$, or the Type I error rate, as 0.05 and run the test as shown below.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">kruskal.test</span><span class="p">(</span><span class="n">gpas</span><span class="p">,</span><span class="w"> </span><span class="n">schools</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></div></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>	Kruskal-Wallis rank sum test

data:  gpas and schools
Kruskal-Wallis chi-squared = 3.706, df = 2, p-value = 0.1568
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>The p-value, 0.1568, is greater than $\alpha$, so we fail to reject the null hypothesis.
We do not have sufficient evidence to conclude that the median GPAs
of matriculated students at these three schools are different from each other.</p>

<p>Content last modified on 05 October 2021.</p>

<p>See a problem?  <a href="https://github.com/nathancarter/how2data/issues/new/choose">Tell us</a> or <a href="https://github.com/nathancarter/how2data/tree/main/database/tasks/How to do a Kruskal-Wallis test/R.md">edit the source</a>.</p>
      <h2 id="topics-that-include-this-task">
        
        
          <a href="#topics-that-include-this-task" class="anchor-heading" aria-labelledby="topics-that-include-this-task"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Topics that include this task
        
        
      </h2>
    

<ul>
  <li><a href="../bentley-university-ma214">Bentley University MA214</a></li>
</ul>
      <h2 id="opportunities">
        
        
          <a href="#opportunities" class="anchor-heading" aria-labelledby="opportunities"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Opportunities
        
        
      </h2>
    

<p>This website does not yet contain a solution for this task in any of the following
software packages.</p>

<ul>
  <li>Excel</li>
</ul>

<p>If you can contribute a solution using any of these pieces of software,
see <a href="../contributing">our Contributing page</a> for how to help extend this website.</p>

        

        

        
        
          <hr>
          <footer>
            

            


            
          </footer>
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>

</html>


