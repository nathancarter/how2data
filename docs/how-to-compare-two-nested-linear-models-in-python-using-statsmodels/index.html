

<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">

  
    <title>How to compare two nested linear models (in Python, using statsmodels) - How to Data</title>

    
  

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">


  <link rel="stylesheet" href="/assets/css/just-the-docs-default.css">

  

  
    <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script>
  

  

  <script type="text/javascript" src="/assets/js/just-the-docs.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>How to compare two nested linear models (in Python, using statsmodels) | How to Data</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="How to compare two nested linear models (in Python, using statsmodels)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Reference site for common computing tasks in statistics and data science" />
<meta property="og:description" content="Reference site for common computing tasks in statistics and data science" />
<link rel="canonical" href="https://how-to-data.org/how-to-compare-two-nested-linear-models-in-python-using-statsmodels/" />
<meta property="og:url" content="https://how-to-data.org/how-to-compare-two-nested-linear-models-in-python-using-statsmodels/" />
<meta property="og:site_name" content="How to Data" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="How to compare two nested linear models (in Python, using statsmodels)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Reference site for common computing tasks in statistics and data science","headline":"How to compare two nested linear models (in Python, using statsmodels)","url":"https://how-to-data.org/how-to-compare-two-nested-linear-models-in-python-using-statsmodels/"}</script>
<!-- End Jekyll SEO tag -->


  
<!--
  --
  --  Configure MathJax to permit $...$ for inline matht
  --
  -->

<script type="text/javascript">
    MathJax = {
        tex: {
            inlineMath: [['$','$'], ['\\(','\\)']]
        },
        svg: {
            fontCache: 'global'
        }
    }
</script>

<!--
  --
  --  Import MathJax
  --
  -->

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript"
        id="MathJax-script"
        async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

<!--
  --
  --  Fix inconsistent gutter width for code cells
  --  And let tables wrap rather than need to scroll.
  --  (Otherwise it's not even obvious that there's content to scroll to.)
  --
  -->

<style>
    .rouge-gutter {
        width: 3em;
    }
    .main-content table a {
        white-space: unset;
    }
</style>

<!--
  --
  --  Add copy buttons to all code input cells
  --  and make those cells slightly visually distinctive
  --
  -->

<script type="text/javascript">
    function makeButton () {
        const button = document.createElement( 'button' )
        button.setAttribute( 'aria-label', 'Copy code to clipboard' )
        button.innerText = 'Copy'
        button.style.float = 'right'
        button.classList.add( 'btn' )
        return button
    }
    const isNotPlainText = element =>
        !element.classList.contains( 'language-plaintext' ) &&
        ( !( element.parentNode instanceof Element )
            || isNotPlainText( element.parentNode ) )
    window.addEventListener( 'load', () => {
        Array.from( document.body.getElementsByClassName( 'rouge-code' ) )
        .forEach( codeBlock => {
            if ( isNotPlainText( codeBlock ) ) {
                // If it's an input code block, do this:
                // 1. Insert the "copy" button
                const button = makeButton()
                codeBlock.insertBefore( button, codeBlock.childNodes[0] )
                button.addEventListener( 'click', () => {
                    button.innerText = '' // don't copy the word "copy"
                    window.navigator.clipboard.writeText( codeBlock.innerText )
                    button.innerText = 'Copied!'
                    setTimeout( () => button.innerText = 'Copy', 3000 )
                } )
                // 2. Adjust border style
                const surrounding = codeBlock.closest( '.highlighter-rouge' )
                if ( surrounding )
                    surrounding.style.border = '1px solid #2869e6'
            } else {
                // But if it's an output code block, remove the line numbers.
                const surrounding = codeBlock.closest( '.highlighter-rouge' )
                if ( surrounding )
                    Array.from( surrounding.querySelectorAll('.lineno') )
                    .forEach( lineno => lineno.style.visibility = 'hidden' )
            }
        } )
    } )
</script>

<!--
  --
  --  Add logo image above nav bar
  --
  -->

<style>
    .nav-list {
        padding-top: 180px;
        background-image: url(/assets/images/H2Dlogo2.svg);
        background-repeat: no-repeat;
        background-position: 24px -2px;
        background-size: 153px 153px;
    }
</style>



</head>

<body>
  <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
    <symbol id="svg-link" viewBox="0 0 24 24">
      <title>Link</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
        <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
      </svg>
    </symbol>
    <symbol id="svg-search" viewBox="0 0 24 24">
      <title>Search</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
        <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
      </svg>
    </symbol>
    <symbol id="svg-menu" viewBox="0 0 24 24">
      <title>Menu</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
        <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
      </svg>
    </symbol>
    <symbol id="svg-arrow-right" viewBox="0 0 24 24">
      <title>Expand</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    </symbol>
    <symbol id="svg-doc" viewBox="0 0 24 24">
      <title>Document</title>
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
      </svg>
    </symbol>
    <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE -->
<symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link">
  <title id="svg-external-link-title">(external link)</title>
  <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line>
</symbol>

  </svg>

  <div class="side-bar">
    <div class="site-header">
      <a href="/" class="site-title lh-tight">
  How to Data

</a>
      <a href="#" id="menu-button" class="site-button">
        <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
      </a>
    </div>
    <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      
      
        <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Welcome</a></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li><li class="nav-list-item"><a href="/topics/" class="nav-list-link">Topics</a></li><li class="nav-list-item"><a href="/tasks/" class="nav-list-link">Tasks</a></li><li class="nav-list-item"><a href="/software/" class="nav-list-link">Software Packages</a></li><li class="nav-list-item"><a href="/acknowledgments/" class="nav-list-link">Acknowledgments</a></li><li class="nav-list-item"><a href="/contributing/" class="nav-list-link">Contributing</a></li><li class="nav-list-item"><a href="/project-status/" class="nav-list-link">Project Status</a></li></ul>
      
      
    </nav>

    
    
      

    
  </div>
  <div class="main" id="top">
    <div id="main-header" class="main-header">
      

        

        <div class="search">
          <div class="search-input-wrap">
            <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search How to Data" aria-label="Search How to Data" autocomplete="off">
            <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
          </div>
          <div id="search-results" class="search-results"></div>
        </div>
      
      
      
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
      
      <div id="main-content" class="main-content" role="main">
        
          <h1 id="how-to-compare-two-nested-linear-models-in-python-using-statsmodels">
        
        
          <a href="#how-to-compare-two-nested-linear-models-in-python-using-statsmodels" class="anchor-heading" aria-labelledby="how-to-compare-two-nested-linear-models-in-python-using-statsmodels"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> How to compare two nested linear models (in Python, using statsmodels)
        
        
      </h1>
    

<p><a href="../how-to-compare-two-nested-linear-models">See all solutions.</a></p>
      <h2 id="task">
        
        
          <a href="#task" class="anchor-heading" aria-labelledby="task"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Task
        
        
      </h2>
    

<p>Model $A$ is said to be “nested” in model $B$ if the predictors included in $A$ are a subset of those included in $B$.  In such a situation, how can we determine if the larger model (in this case $B$) is significantly better than the smaller (reduced) model?  We can use an Extra Sums of Squares test, also called a partial $F$-test, to compare two nested linear.</p>

<p>This technique will also help us with another question.  If we have a multivarate linear model,</p>

\[\hat{y}=\beta_0 + \beta_1x_1 + \beta_2x_2 + \cdots + \beta_kx_k,\]

<p>how can we test the influence of only some of the coefficients?  If we remove some of the coefficients,
we have a smaller model nested in the larger one, so the question is the same.</p>

<p>Related tasks:</p>

<ul>
  <li><a href="../how-to-do-a-one-way-analysis-of-variance-anova">How to do a one-way analysis of variance (ANOVA)</a></li>
  <li><a href="../how-to-conduct-a-mixed-designs-anova">How to conduct a mixed designs ANOVA</a></li>
  <li><a href="../how-to-conduct-a-repeated-measures-anova">How to conduct a repeated measures ANOVA</a></li>
  <li><a href="../how-to-perform-an-analysis-of-covariance-ancova">How to perform an analysis of covariance (ANCOVA)</a></li>
</ul>
      <h2 id="solution">
        
        
          <a href="#solution" class="anchor-heading" aria-labelledby="solution"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Solution
        
        
      </h2>
    

<!-- beginning of wrapper -->

<p>The solution below uses an example dataset about car design and fuel consumption from a 1974 Motor Trend magazine.  (See <a href="../how-to-quickly-load-some-sample-data">how to quickly load some sample data</a>.)</p>

<p>We will create two models, one nested inside the other, in a natural way in this example.
But this is not the only way to create nested models; it is just an example.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">rdatasets</span> <span class="kn">import</span> <span class="n">data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="p">(</span><span class="s">'mtcars'</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<p>Consider a model using number of cylinders (cyl) and weight of car (wt) to predict its fuel efficiency (mpg). We create this model and perform an ANOVA to see if the predictors are significant. We use the Ordinary Least Squares module from <code class="language-plaintext highlighter-rouge">statsmodels</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="n">add_model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s">'mpg ~ cyl + wt'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">).</span><span class="n">fit</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="n">sm</span>
<span class="n">sm</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">add_model</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>df</th>
      <th>sum_sq</th>
      <th>mean_sq</th>
      <th>F</th>
      <th>PR(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cyl</th>
      <td>1.0</td>
      <td>817.712952</td>
      <td>817.712952</td>
      <td>124.043687</td>
      <td>5.424327e-12</td>
    </tr>
    <tr>
      <th>wt</th>
      <td>1.0</td>
      <td>117.162269</td>
      <td>117.162269</td>
      <td>17.773034</td>
      <td>2.220200e-04</td>
    </tr>
    <tr>
      <th>Residual</th>
      <td>29.0</td>
      <td>191.171966</td>
      <td>6.592137</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table></div>
</div>

<p>In the final column of output we see that all numbers are below $0.05$, which suggests that both predictors are significant.  A natural question to ask is whether the two predictors have an interaction effect.  Let’s create a model containing the interaction term.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">int_model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s">'mpg ~ cyl*wt'</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">).</span><span class="n">fit</span><span class="p">()</span>
<span class="n">sm</span><span class="p">.</span><span class="n">stats</span><span class="p">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">int_model</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>df</th>
      <th>sum_sq</th>
      <th>mean_sq</th>
      <th>F</th>
      <th>PR(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>cyl</th>
      <td>1.0</td>
      <td>817.712952</td>
      <td>817.712952</td>
      <td>145.856269</td>
      <td>1.280635e-12</td>
    </tr>
    <tr>
      <th>wt</th>
      <td>1.0</td>
      <td>117.162269</td>
      <td>117.162269</td>
      <td>20.898350</td>
      <td>8.942713e-05</td>
    </tr>
    <tr>
      <th>cyl:wt</th>
      <td>1.0</td>
      <td>34.195767</td>
      <td>34.195767</td>
      <td>6.099533</td>
      <td>1.988242e-02</td>
    </tr>
    <tr>
      <th>Residual</th>
      <td>28.0</td>
      <td>156.976199</td>
      <td>5.606293</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table></div>
</div>

<p>As seen in the final column of output, there is a significant interaction between the two predictors (bottom number being below $0.05$).</p>

<p>We now have one model (<code class="language-plaintext highlighter-rouge">add_model</code>) nested inside a larger model (<code class="language-plaintext highlighter-rouge">int_model</code>).
To check which model is better, we can conduct an ANOVA comparing the two models. We use the <code class="language-plaintext highlighter-rouge">anova_lm</code> function from <code class="language-plaintext highlighter-rouge">statsmodels</code>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><div class="table-wrapper"><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">statsmodels.stats.anova</span> <span class="kn">import</span> <span class="n">anova_lm</span>
<span class="n">anova_lm</span><span class="p">(</span><span class="n">add_model</span><span class="p">,</span> <span class="n">int_model</span><span class="p">)</span>
</pre></td></tr></tbody></table></div></code></pre></div></div>

<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>df_resid</th>
      <th>ssr</th>
      <th>df_diff</th>
      <th>ss_diff</th>
      <th>F</th>
      <th>Pr(&gt;F)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29.0</td>
      <td>191.171966</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>28.0</td>
      <td>156.976199</td>
      <td>1.0</td>
      <td>34.195767</td>
      <td>6.099533</td>
      <td>0.019882</td>
    </tr>
  </tbody>
</table></div>
</div>

<p>We have just performed this hypothesis test:</p>

<p>$H_0 =$ the two models are equally useful for predicting the outcome</p>

<p>$H_a =$ the larger model is significantly better than the smaller model</p>

<p>In the final column of the output, called <strong>Pr(&gt;F)</strong>,
the only number in that column is our test statistic, $0.019882$.
Since is below our chosen threshold of $0.05$, we reject the null hypothesis,
and prefer to use the second model.</p>

<p>This method can be used to check if covariates should be included in the model, or if additional variables should be added as well.</p>

<p>Content last modified on 17 May 2023.</p>

<p>See a problem?  <a href="https://github.com/nathancarter/how2data/issues/new/choose">Tell us</a> or <a href="https://github.com/nathancarter/how2data/tree/main/database/tasks/How to compare two nested linear models/Python, using statsmodels.ipynb">edit the source</a>.</p>

<!-- ending of wrapper -->

<p>Contributed by Krtin Juneja (KJUNEJA@falcon.bentley.edu)</p>

        

        

        
        
          <hr>
          <footer>
            

            


            
          </footer>
        

      </div>
    </div>

    
      

      <div class="search-overlay"></div>
    
  </div>
</body>

</html>


